<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>文件格式化输出</title>
</head>
<body>
<input type="file" id="fileInput" />
<pre id="output"></pre>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>

<script>
    function formatOutput(fileData, fileType) {
        var formattedData;

        // 根据文件类型进行格式化
        if (fileType === 'yaml') {
            formattedData = jsyaml.safeDump(fileData);
        } else if (fileType === 'csv') {
            formattedData = Papa.parse(fileData).data;
        } else if (fileType === 'xml') {
            formattedData = formatXml(fileData);
        } else if (fileType === 'json') {
            formattedData = formatJson(fileData);
        } else {
            formattedData = '不支持的文件类型';
        }

        document.getElementById('output').innerHTML = formattedData;
    }

    function formatXml(xmlString) {
        // 创建一个 DOMParser 对象
        var parser = new DOMParser();

        // 解析 XML 字符串
        var xmlDoc = parser.parseFromString(xmlString, 'application/xml');

        // 创建一个 XMLSerializer 对象
        var serializer = new XMLSerializer();

        // 使用 serializer 将 XML 文档转换为字符串
        var formattedXml = serializer.serializeToString(xmlDoc);

        return formattedXml;
    }

    function formatJson(jsonString) {
        // 解析 JSON 并格式化
        var jsonObject = JSON.parse(jsonString);
        var formattedJson = JSON.stringify(jsonObject, null, 2);
        return formattedJson;
    }

    document.getElementById('fileInput').addEventListener('change', function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();

        reader.onload = function(e) {
            var fileData = e.target.result;
            var fileType = file.name.split('.').pop().toLowerCase();

            formatOutput(fileData, fileType);
        };

        reader.readAsText(file);
    });
</script>
</body>
</html>
